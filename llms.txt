# Quicklify

> Your self-hosted PaaS, fully managed. Deploy, secure, back up — one command at a time.

Quicklify is an open-source CLI tool that automates the deployment, security, backup, and maintenance of self-hosted platforms on cloud VPS providers. Supports two modes: **Coolify** (self-hosted PaaS) and **Bare** (generic VPS without Coolify).

## Installation

```bash
npx quicklify            # Interactive menu (recommended)
npx quicklify <command>  # Direct command
# or
npm install -g quicklify
```

Requires Node.js 20+.

## Server Modes

| Mode | Description | Use Case |
|------|-------------|----------|
| `coolify` | Deploys Coolify PaaS (default) | App hosting, CI/CD, databases |
| `bare` | Generic VPS with hardening only | Custom setups, n8n, Node.js, etc. |

```bash
quicklify init --mode bare --provider hetzner   # Generic VPS
quicklify add --mode bare                       # Register existing VPS
```

## Commands (23 total)

### Deploy
- `quicklify init` — Deploy a new server (interactive or non-interactive)
  - `--provider <name>` — hetzner, digitalocean, vultr, linode
  - `--mode <mode>` — coolify (default), bare
  - `--token <token>` — API token (or use env vars: HETZNER_TOKEN, DIGITALOCEAN_TOKEN, etc.)
  - `--region <region>` — Server region
  - `--size <size>` — Server size
  - `--name <name>` — Server name
  - `--config <path>` — Load from YAML config file
  - `--template <name>` — starter, production, dev
  - `--full-setup` — Auto-configure firewall + SSH hardening
  - `--no-open` — Do not open browser after deployment

### Server Management
- `quicklify list` — List all registered servers (shows mode per server)
- `quicklify status [query]` — Check server status (`--all`, `--autostart`)
- `quicklify ssh [query]` — SSH into a server (`-c <command>`)
- `quicklify restart [query]` — Restart a server via provider API
- `quicklify destroy [query]` — Destroy a cloud server (with confirmation)
- `quicklify add` — Add an existing server (`--mode bare`, `--skip-verify`)
- `quicklify remove [query]` — Remove from local config (no cloud action)
- `quicklify config [subcommand]` — Manage default configuration
- `quicklify export [path]` — Export server list to JSON
- `quicklify import <path>` — Import servers from JSON

### Update & Maintain
- `quicklify update [query]` — Update Coolify (`--all`) — Coolify mode only
- `quicklify maintain [query]` — Full maintenance cycle (`--all`, `--skip-reboot`, `--dry-run`) — Coolify mode only

### Backup & Restore
- `quicklify backup [query]` — Backup DB + config via SCP (`--all`, `--dry-run`)
- `quicklify restore [query]` — Restore from backup (`--backup <timestamp>`, `--dry-run`)

### Snapshots
- `quicklify snapshot create [query]` — Create VPS snapshot with cost estimate
- `quicklify snapshot list [query]` — List snapshots (`--all`)
- `quicklify snapshot delete [query]` — Delete a snapshot

### Security
- `quicklify firewall <subcommand> [query]` — Manage UFW (setup, add, remove, list, status)
- `quicklify domain <subcommand> [query]` — Manage domain + SSL (add, remove, check, list)
- `quicklify secure <subcommand> [query]` — SSH hardening + fail2ban (setup, status, audit)

### Diagnostics
- `quicklify monitor [query]` — CPU, RAM, disk usage (`--containers`)
- `quicklify logs [query]` — View logs (`-f` follow, `-s` service, `-n` lines)
- `quicklify health` — Health check all servers
- `quicklify doctor` — Check local environment (`--check-tokens`)

## Supported Providers

| Provider | Status | Env Variable |
|----------|--------|-------------|
| Hetzner Cloud | Stable | `HETZNER_TOKEN` |
| DigitalOcean | Stable | `DIGITALOCEAN_TOKEN` |
| Vultr | Stable | `VULTR_TOKEN` |
| Linode (Akamai) | Beta | `LINODE_TOKEN` |

## MCP Server (AI Integration)

Built-in Model Context Protocol server for AI-powered server management. Works with Claude Code, Cursor, Windsurf, and other MCP-compatible clients.

**Binary**: `quicklify-mcp` (stdio transport)

### Available Tools (7)

| Tool | Actions | Description |
|------|---------|-------------|
| `server_info` | list, status, health, sizes | Query server info, check status, list available sizes |
| `server_logs` | logs, monitor | Fetch logs and system metrics via SSH |
| `server_manage` | add, remove, destroy | Register, unregister, or destroy servers |
| `server_maintain` | update, restart, maintain | Update Coolify, restart, full maintenance |
| `server_secure` | secure-setup, secure-audit, firewall-*, domain-* | Security, firewall, domain management (10 actions) |
| `server_backup` | backup-*, snapshot-* | Backup/restore + VPS snapshots (6 actions) |
| `server_provision` | create | Provision new servers (Coolify or bare mode) |

### SAFE_MODE (default: enabled)

Destructive operations blocked by default: `destroy`, `restore`, `snapshot-delete`, `provision`, `restart`, `maintain`, `snapshot-create`. Set `QUICKLIFY_SAFE_MODE=false` to enable.

### MCP Configuration

```json
{
  "mcpServers": {
    "quicklify": {
      "command": "npx",
      "args": ["-y", "-p", "quicklify", "quicklify-mcp"],
      "env": {
        "HETZNER_TOKEN": "your-token",
        "DIGITALOCEAN_TOKEN": "your-token",
        "VULTR_TOKEN": "your-token",
        "LINODE_TOKEN": "your-token"
      }
    }
  }
}
```

## Architecture

- **Runtime**: Node.js 20+ (ESM)
- **CLI Framework**: Commander.js
- **Prompts**: Inquirer.js (interactive mode with back navigation)
- **HTTP**: Axios (provider API calls)
- **Logging**: Chalk + Ora (spinners)
- **Config**: YAML (js-yaml) + JSON
- **MCP**: @modelcontextprotocol/sdk + Zod (input validation)
- **Config Storage**: `~/.quicklify/` (servers.json, config.json, backups/)
- **Testing**: Jest (2,047 tests, 76 suites, ~95% coverage)
- **Linting**: ESLint 10 + typescript-eslint + Prettier

## Security Model

- API tokens NEVER stored on disk — runtime prompt or env vars only
- SSH: IP validation (`assertValidIp`), env filtering (`sanitizedEnv`), StrictHostKeyChecking
- Shell injection protection on all inputs (spawn/spawnSync, no execSync)
- Provider errors sanitized (`stripSensitiveData`) — no token leakage
- stderr sanitization (`sanitizeStderr`) — redacts IPs, paths, tokens, secrets
- Path traversal protection (`assertSafePath`) on backup/restore paths
- YAML config: 22+ security key patterns detected and warned
- Import/export: sensitive field stripping + strict file permissions (0o600)
- MCP: SAFE_MODE blocks destructive ops, Zod schema validation, path traversal guards

## Links

- Repository: https://github.com/omrfc/quicklify
- npm: https://www.npmjs.com/package/quicklify
- Issues: https://github.com/omrfc/quicklify/issues
- License: MIT
